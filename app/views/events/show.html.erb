<% content_for :title, "Trellixe - #{@event.name}" %>

<% content_for :page_header do %>
  <div class="flex items-center gap-half text-sm i-full">
    <%= link_to "Events", events_path, class: "text-subtle hover:text-primary" %>
    <span class="text-subtle">/</span>
    <span class="text-primary overflow-ellipsis"><%= @event.name %></span>
  </div>
<% end %>

<%# --- Main Page Container --- %>
<div class="flex flex-col gap p-4">

  <%# --- Event Header Section --- %>
  <div class="bg-surface rounded-md border p-6 flex items-start justify-between gap-5">
    <div>
      <h1 class="text-3xl font-semibold mbe-1"><%= @event.name %></h1>
      <p class="text-sm text-subtle"><%= @event.starts_at.strftime("%A, %B %d, %Y from %I:%M %p") %> to <%= @event.ends_at.strftime("%I:%M %p") %></p>
    </div>
    <%# --- At-a-Glance Stats --- %>
    <div class="flex items-center gap text-center">
      <div>
        <p class="text-xl font-semibold"><%= @stats[:accepted] %></p>
        <p class="text-xs uppercase text-subtle">Accepted</p>
      </div>
      <div>
        <p class="text-xl font-semibold"><%= @stats[:attended] %></p>
        <p class="text-xs uppercase text-subtle">Attended</p>
      </div>
      <div>
        <p class="text-xl font-semibold"><%= @stats[:total] %></p>
        <p class="text-xs uppercase text-subtle">Invited</p>
      </div>
      <div>
        <p class="text-xl font-semibold"><%= @stats[:declined] %></p>
        <p class="text-xs uppercase text-subtle">Declined</p>
      </div>
    </div>
  </div>

  <%# --- Main Content Area: Invitation List and Invite Form --- %>
  <div class="flex flex-col gap bg-surface rounded-md border p-6">

    <%# --- Invitation List Section --- %>
    <div>
      <h2 class="text-xl font-semibold mbe-4">Invitation List Management</h2>
      <%= turbo_frame_tag "guest_list" do %>
        <% if @invitations.any? %>
          <% @invitations.each do |invitation| %>
            <%= render invitation %>
          <% end %>
        <% else %>
          <p class="text-sm text-subtle">No guests have been invited to this event yet.</p>
        <% end %>
      <% end %>
    </div>

    <%# --- Separator --- %>
    <div>
      <h3 class="text-lg font-semibold">Invite Contacts</h3>
      <%= turbo_frame_tag "new_invitation_form" do %>
        <%= render "invitations/form", event: @event, invitation: @new_invitation %>
      <% end %>
    </div>
  </div>
</div>
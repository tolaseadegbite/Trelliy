<!--<div contents data-controller="popover" data-popover-placement-value="bottom-start">
  <button type="button" class="btn mbe-4" data-popover-target="trigger" popovertarget="popover" aria-haspopup="true">
    <span class="icon icon--search"></span>
    <span>Search events</span>
  </button>
  <div popover id="popover" class="popover p-4 bg-main" style="" data-popover-target="content" role="menu" aria-label="Menu">
    <%= search_form_for @search, url: events_path do |f| %>
      <%= hidden_field_tag :view, 'events-list' %>

      <div class="grid grid-cols-1 grid-cols-12@md gap-4 mbe-6">
        <%# --- Search by Name (existing) --- %>
        <div class="col-span-12 col-span-3@lg">
          <%= f.label :name_cont, "Event Name", class: "font-medium" %>
          <%= f.search_field :name_cont, placeholder: "Contains...", class: "input i-full mbs-1" %>
        </div>

        <%# --- Filter by Date Range (new) --- %>
        <div class="col-span-6 col-span-1@lg">
          <%= f.label :starts_at_gteq, "From", class: "font-medium mbs-1" %>
          <%= f.date_field :starts_at_gteq, class: "input i-full mbs-1" %>
        </div>
        
        <div class="col-span-6 col-span-1@lg">
          <%= f.label :starts_at_lteq, "To", class: "font-medium" %>
          <%= f.date_field :starts_at_lteq, class: "input i-full mbs-1" %>
        </div>

        <%# --- Filter by Invited Contact (new) --- %>
        <div class="col-span-12 col-span-1@lg">
          <%= f.label :invited_contacts_id_eq, "Contact", class: "font-medium" %>
          <%= f.collection_select :invited_contacts_id_eq, @filterable_contacts, :id, :full_name, { include_blank: 'Select Contact' }, { class: "i-full mbs-1", data: { controller: "combobox" } } %>
        </div>
      </div>

      <%# --- Form Actions --- %>
      <div class="flex items-center gap mbe-4">
        <%= link_to "Reset all", events_path(view: "events-list"), class: "btn" if params.has_key?(:q) %>
        <%= f.submit "Search", class: "btn btn--primary" %>
      </div>
    <% end %>
  </div>
</div>-->

<div class="mbe-4"
     data-controller="search-filter"
     data-action="click@window->search-filter#closeOnClickOutside">

  <%# Button to toggle the visibility of the filters %>
  <button type="button" class="btn btn--subtle mbe-4" data-action="search-filter#toggle">
    <span class="icon icon--search"></span>
    <span>Search events</span>
  </button>

  <div class="hide mbe-4 p-4 bg-surface border rounded-md" data-search-filter-target="filters">
    <%= search_form_for @search, url: events_path do |f| %>
      <%= hidden_field_tag :view, 'events-list' %>

      <div class="grid grid-cols-1 grid-cols-12@md gap-4 mbe-6">
        <%# --- Search by Name (existing) --- %>
        <div class="col-span-12 col-span-3@lg">
          <%= f.label :name_cont, "Event Name", class: "font-medium" %>
          <%= f.search_field :name_cont, placeholder: "Contains...", class: "input i-full mbs-1" %>
        </div>

        <%# --- Filter by Date Range (new) --- %>
        <div class="col-span-6 col-span-1@lg">
          <%= f.label :starts_at_gteq, "From", class: "font-medium mbs-1" %>
          <%= f.date_field :starts_at_gteq, class: "input i-full mbs-1", data: { controller: "datepicker" } %>
        </div>
        
        <div class="col-span-6 col-span-1@lg">
          <%= f.label :starts_at_lteq, "To", class: "font-medium" %>
          <%= f.date_field :starts_at_lteq, class: "input i-full mbs-1", data: { controller: "datepicker" } %>
        </div>

        <%# --- Filter by Invited Contact (new) --- %>
        <div class="col-span-12 col-span-1@lg">
          <%= f.label :invited_contacts_id_eq, "Contact", class: "font-medium" %>
          <%= f.collection_select :invited_contacts_id_eq, @filterable_contacts, :id, :full_name, { include_blank: 'Select Contact' }, { class: "i-full mbs-1", data: { controller: "combobox" } } %>
        </div>
      </div>

      <%# --- Form Actions --- %>
      <div class="flex items-center gap mbe-4">
        <%= link_to "Reset all", events_path(view: "events-list"), class: "btn" if params.has_key?(:q) %>
        <%= f.submit "Search", class: "btn btn--primary" %>
      </div>
    <% end %>
  </div>
</div>